{"version":3,"file":"index.js","sources":["../../../packages/tbPopup/index.js"],"sourcesContent":["// 弹框组件\r\nimport './index.less'\r\n// 接收配置项\r\nconst defaultOptions = {\r\n    title: {\r\n        text: '标题',\r\n        textAlign: 'center',\r\n    },\r\n    width: '100vw',\r\n    height: '30vh',\r\n    content: document.createTextNode('内容'),\r\n    footer: null,\r\n    mask: true,\r\n    leftBtn: {\r\n        text: '取消',\r\n        callback: null\r\n    },\r\n    rightBtn: {\r\n        text: '确定',\r\n        callback: null\r\n    },\r\n}\r\n/**\r\n * {\r\n *   title: {\r\n *    text: String, // 标题文本\r\n *    style: Object // 标题样式\r\n * }\r\n * }\r\n */\r\n// 1. title: 抽屉标题\r\n// 2. width: 抽屉宽度\r\n// 3. height: 抽屉高度\r\n// 4. content: 抽屉内容 节点或字符串 如果是字符串 默认获取该id的节点下的内容\r\n// 5. footer: 抽屉底部按钮 默认无\r\nclass TbPopup {\r\n    constructor(options) {\r\n        // 合并配置项\r\n        this.options = Object.assign({}, defaultOptions, options)\r\n        // 创建抽屉\r\n        this.createPopup()\r\n    }\r\n    // 创建抽屉\r\n    createPopup() {\r\n        // 创建抽屉\r\n        this.popup = document.createElement('div')\r\n        // 设置抽屉样式\r\n        this.popup.className = 'tb-popup'\r\n        this.popup.style.width = this.options.width\r\n        this.popup.style.minHeight = this.options.height\r\n        // 创建抽屉标题\r\n        this.createTitle()\r\n        // 创建抽屉内容\r\n        this.createContent()\r\n        // 创建遮罩层\r\n        this.createMask()\r\n        // 将抽屉添加到页面\r\n        document.body.appendChild(this.popup)\r\n    }\r\n    // 创建抽屉头部\r\n    createTitle() {\r\n        // 创建头部\r\n        this.header = document.createElement('div')\r\n        this.header.className = 'tb-popup-header'\r\n        this.title = document.createElement('div')\r\n        // 设置头部样式\r\n        this.title.className = 'tb-popup-title'\r\n        // 判断有无两侧按钮\r\n        if (this.options.leftBtn ) {\r\n            this.title.className += ' tb-popup-title-has-left-btn'\r\n            // 创建左侧按钮\r\n            this.leftBtn = document.createElement('div')\r\n            // 设置左侧按钮样式\r\n            this.leftBtn.className = 'tb-popup-left-btn'\r\n            // 设置左侧按钮文本\r\n            this.leftBtn.textContent = this.options.leftBtn.text\r\n            // 事件监听\r\n            this.leftBtn.addEventListener('click', () => {\r\n                this.options.leftBtn.callback ? this.options.leftBtn.callback() : this.close()\r\n            })\r\n            // 将左侧按钮添加到头部中\r\n            this.title.appendChild(this.leftBtn)\r\n        }\r\n        // 设置标题\r\n        const titleText = document.createElement('div')\r\n        titleText.className = 'tb-popup-title-text'\r\n        // 设置标题文本居中\r\n        titleText.style.textAlign = this.options.title.textAlign\r\n        // 设置标题文本\r\n        titleText.textContent = this.options.title.text\r\n        // 将标题文本添加到标题中\r\n        this.title.appendChild(titleText)\r\n        if (this.options.rightBtn) {\r\n            this.title.className += ' tb-popup-title-has-right-btn'\r\n            // 创建右侧按钮\r\n            this.rightBtn = document.createElement('div')\r\n            // 设置右侧按钮样式\r\n            this.rightBtn.className = 'tb-popup-right-btn'\r\n            // 设置右侧按钮文本\r\n            this.rightBtn.textContent = this.options.rightBtn.text\r\n            // 将右侧按钮添加到头部中\r\n            this.title.appendChild(this.rightBtn)\r\n        }\r\n        // 如果两侧存在一个或两个按钮 并且设置标题文字居中 则标题两侧都预留padding\r\n        if (this.options.title.titleAlign === 'center' && (this.options.leftBtn || this.options.rightBtn)) {\r\n            this.title.className = 'tb-popup-title tb-popup-title-has-right-btn tb-popup-title-has-left-btn'\r\n        }\r\n        // 设置标题文本\r\n        this.header.appendChild(this.title)\r\n        // 将头部添加到抽屉中\r\n        this.popup.appendChild(this.header)\r\n    }\r\n    // 创建抽屉内容\r\n    createContent() {\r\n        // 创建内容\r\n        this.content = document.createElement('div')\r\n        // 设置内容样式\r\n        this.content.className = 'tb-popup-content'\r\n        // 如果内容是字符串 则获取该id的节点下的内容\r\n        if (typeof this.options.content === 'string') {\r\n            const doms = document.getElementById(this.options.content).childNodes\r\n            const domFragment = document.createDocumentFragment()\r\n            if (doms.length > 0) {\r\n                doms.forEach(dom => {\r\n                    domFragment.appendChild(dom.cloneNode(true))\r\n                })\r\n            }\r\n            this.content.appendChild(domFragment)\r\n        } else if (this.options.content instanceof HTMLElement || this.options.content instanceof DocumentFragment) {\r\n            this.content.appendChild(this.options.content)\r\n        } else {\r\n            throw new Error('content参数类型错误, 请传入字符串或者dom节点')\r\n        }\r\n        // 将内容添加到抽屉中\r\n        this.popup.appendChild(this.content)\r\n    }\r\n    // 创建遮罩层\r\n    createMask() {\r\n        // 创建遮罩层\r\n        this.mask = document.createElement('div')\r\n        // 设置遮罩层样式\r\n        this.mask.style.width = '100vw'\r\n        this.mask.style.height = '100vh'\r\n        this.mask.style.backgroundColor = 'rgba(0,0,0,.5)'\r\n        this.mask.style.position = 'fixed'\r\n        this.mask.style.left = 0\r\n        this.mask.style.bottom = '-100vh'\r\n        this.mask.style.zIndex = 999\r\n        // 设置遮罩层过渡效果 颜色过渡时间为.3s\r\n        this.mask.style.transition = 'opacity .3s'\r\n\r\n        // 事件监听，如果点击遮罩层 则关闭抽屉 \r\n        this.mask.addEventListener('click', () => {\r\n            this.close()\r\n        })\r\n        // 将遮罩层添加到页面中\r\n        document.body.appendChild(this.mask)\r\n    }\r\n    // 创建关闭按钮\r\n    createClose() {\r\n        // 创建关闭按钮\r\n        this.close = document.createElement('div')\r\n        // 设置关闭按钮样式\r\n        this.close.className = 'tb-popup-close'\r\n        // 设置关闭按钮文本\r\n        this.close.textContent = 'X'\r\n        // 事件监听\r\n        this.close.addEventListener('click', () => {\r\n            this.close()\r\n        })\r\n        // 将关闭按钮添加到抽屉中\r\n        this.popup.appendChild(this.close)\r\n    }\r\n    show () {\r\n        this.mask.style.opacity = 1\r\n        this.popup.style.bottom = 0\r\n        this.mask.style.transform = 'translateY(-100vh)'\r\n    }\r\n    close () {\r\n        this.popup.style.bottom = '-100%'\r\n        this.mask.style.opacity = 0\r\n        // 过渡结束后隐藏mask\r\n        this.popup.addEventListener('transitionend', () => {\r\n        this.mask.style.transform = 'translateY(100vh)'\r\n        }, {\r\n            once: true\r\n        })\r\n    }\r\n}\r\nexport default TbPopup"],"names":["defaultOptions","title","text","textAlign","width","height","content","document","createTextNode","footer","mask","leftBtn","callback","rightBtn","constructor","options","this","Object","assign","createPopup","popup","createElement","className","style","minHeight","createTitle","createContent","createMask","body","appendChild","header","textContent","addEventListener","close","titleText","titleAlign","doms","getElementById","childNodes","domFragment","createDocumentFragment","length","forEach","dom","cloneNode","HTMLElement","DocumentFragment","Error","backgroundColor","position","left","bottom","zIndex","transition","createClose","show","opacity","transform","once"],"mappings":"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"}